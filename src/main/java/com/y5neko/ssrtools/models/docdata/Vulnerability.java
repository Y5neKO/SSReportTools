package com.y5neko.ssrtools.models.docdata;

import com.y5neko.ssrtools.services.VulnerabilityService;

import java.io.FileNotFoundException;

/**
 * 漏洞模型
 */
public class Vulnerability {
    private VulnerabilityService vulnerabilityService = new VulnerabilityService();

    private String name = "测试漏洞";
    private String vulDesc = "漏洞库中不存在描述，请手动填写";
    private String riskLevel = "漏洞库中不存在等级，请手动填写";
    private String vulHazards = "漏洞库中不存在危害，请手动填写";
    private String vulLinks = "请手动填写漏洞链接";
    private String vulDetail = "请手动填写漏洞证明";
    private String vulFixSuggestion = "漏洞库中不存在修复建议，请手动填写";
    private String isFixed = "请手动填写修复情况";

    /**
     * 构造函数
     * @param name 漏洞名称
     * @throws FileNotFoundException Except
     */
    public Vulnerability(String name) throws FileNotFoundException {
        this.name = name;
        VulnerabilityService.Vulnerability vulnerability = vulnerabilityService.getVulnerability(name);
        if (vulnerability != null) {
            this.vulDesc = vulnerability.getDescription();
            this.riskLevel = vulnerability.getRiskLevel();
            this.vulHazards = vulnerability.getHarm();
            this.vulFixSuggestion = vulnerability.getSuggustion();
        }
    }

    // ================================== getter & setter =============================================

    public VulnerabilityService getVulnerabilityService() {
        return vulnerabilityService;
    }

    public void setVulnerabilityService(VulnerabilityService vulnerabilityService) {
        this.vulnerabilityService = vulnerabilityService;
    }

    public String getIsFixed() {
        return isFixed;
    }

    public void setIsFixed(String isFixed) {
        this.isFixed = isFixed;
    }

    public String getVulFixSuggestion() {
        return vulFixSuggestion;
    }

    public void setVulFixSuggestion(String vulFixSuggestion) {
        this.vulFixSuggestion = vulFixSuggestion;
    }

    public String getVulDetail() {
        return vulDetail;
    }

    public void setVulDetail(String vulDetail) {
        this.vulDetail = vulDetail;
    }

    public String getVulLinks() {
        return vulLinks;
    }

    public void setVulLinks(String vulLinks) {
        this.vulLinks = vulLinks;
    }

    public String getVulHazards() {
        return vulHazards;
    }

    public void setVulHazards(String vulHazards) {
        this.vulHazards = vulHazards;
    }

    public String getRiskLevel() {
        return riskLevel;
    }

    public void setRiskLevel(String riskLevel) {
        this.riskLevel = riskLevel;
    }

    public String getVulDesc() {
        return vulDesc;
    }

    public void setVulDesc(String vulDesc) {
        this.vulDesc = vulDesc;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}